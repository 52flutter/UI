{"version":3,"sources":["../../src/components/TableDrag/table-drag.js"],"names":["MouseHandler","prototype","getEvent","event","window","eventWhich","which","button","eventPageX","pageX","body","document","docElem","documentElement","clientX","scrollLeft","clientLeft","eventPageY","pageY","clientY","scrollTop","clientTop","_mouseDown","_mouseStarted","_mouseUp","_mouseDownEvent","copy","attr","options","distance","_mousePrepareDrag","preventDefault","returnValue","stopPropagation","cancelBubble","_mousePrepareClick","_this","_mouseMoveDelegate","_mouseMove","_mouseUpDelegate","addEvent","_mouseDrag","_mouseDistanceMet","mouseStarted","removeEvent","_mouseStopDrag","_mouseExecuteClick","newEvent","lastEvent","x","Math","abs","y","sqrt","constructor","changeColumn","DragHandler","table","restoreState","newOptions","opt","hr","rows","nc","cells","length","nr","_init","elementStyleProperty","element","prop","getComputedStyle","getPropertyValue","re","test","replace","arguments","toUpperCase","currentStyle","numericProperty","parseInt","eventTarget","target","srcElement","eventTargetTh","e","type","Object","toString","call","parentElement","tridentDetection","navigator","userAgent","indexOf","borderCollapseDetection","getTableColumn","defaultColumn","i","tx","getOffsetRect","left","offsetWidth","copyStyles","el","cs","css","style","loadState","key","state","localStorage","getItem","JSON","parse","Array","getIndex","searchId","index","findIndex","array","id","saveState","console","log","getAttribute","push","splice","setItem","stringify","name","pm","memory","start","end","move","moveTableColumn","trident","borderCollapse","tablePosition","row","rowPosition","rowOffsetHeight","offsetHeight","tableClientLeft","tableClientTop","top","backLeft","backTop","backWidth","backHeight","zIndex","initialColumn","cellIndex","backgroundColor","lc","ic","back","createElement","position","width","height","className","tableLeft","tableParent","tableParentLeft","tableParentWidth","slice","limitLeft","limitRight","minColumn","maxColumn","cell","cellPosition","clientWidth","clientHeight","clientRight","clientBottom","paddingTop","paddingBottom","temp","getBoundingClientRect","computedCellHeight","bottom","borderLeftWidth","borderTopWidth","borderRightWidth","borderBottomWidth","elementBaseLeft","elementBaseTop","elementBaseWidth","elementBaseHeight","cssText","innerHTML","elementBase","setAttribute","de","appendChild","elementBaseLimitRight","opacity","overlay","cur","cursor","lastColumn","eventColumn","borderSpacing","direction","sign","shift","layerOne","childNodes","layerTwo","removeChild","col","TableDrag","tagName","dragHandler","module","exports","defineProperty","enumerable","configurable","writable","value","predicate","TypeError","list","thisArg","obj","fn","attachEvent","addEventListener","detachEvent","removeEventListener","elem","box","pageYOffset","pageXOffset","round","insertBefore","NaN","from","to"],"mappings":"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","file":"table-drag.js","sourcesContent":[";(function () {\r\n    \"use strict\";\r\n\r\n\t// Dragging (drag'n'drop) columns of html tables.\r\n\t// https://github.com/irhc/mouse-handler\r\n    function MouseHandler () {\r\n\t\t//this._mouseDownEvent\r\n\t\t//this._mouseStarted\r\n\t\t//this._mouseMoveDelegate\r\n\t\t//this._mouseUpDelegate\r\n    }\r\n    MouseHandler.prototype = (function () {\r\n\t\t// helper functions\r\n\r\n\t\t// Cross browser event data based on\r\n\t\t// jquery implementation\r\n\t\tfunction getEvent(event) {\r\n\t\t\treturn event || window.event;\r\n\t\t}\r\n\t\tfunction eventWhich(event) {\r\n\t\t\treturn event.which || event.button;\r\n\t\t}\r\n\t\tfunction eventPageX(event) {\r\n\t\t\tvar pageX = event.pageX;\r\n\r\n\t\t\tif (typeof pageX == 'undefined') {\r\n\t\t\t\tvar body = document.body;\r\n\t\t\t\tvar docElem = document.documentElement;\r\n\t\t\t\tpageX = event.clientX + (docElem && docElem.scrollLeft || body && body.scrollLeft || 0) - (docElem && docElem.clientLeft || body && body.clientLeft || 0);\r\n\t\t\t}\r\n\r\n\t\t\treturn pageX;\r\n\t\t}\r\n\t\tfunction eventPageY(event) {\r\n\t\t\tvar pageY = event.pageY;\r\n\r\n\t\t\tif (typeof pageY == 'undefined') {\r\n\t\t\t\tvar body = document.body;\r\n\t\t\t\tvar docElem = document.documentElement;\r\n\t\t\t\tpageY = event.clientY + (docElem && docElem.scrollTop || body && body.scrollTop || 0) - (docElem && docElem.clientTop || body && body.clientTop || 0);\r\n\t\t\t}\r\n\r\n\t\t\treturn pageY;\r\n\t\t}\r\n\r\n\t\t// prototype functions\r\n\r\n        function _mouseDown(event) {\r\n\t\t\t// ie8 support\r\n            event = getEvent(event);\r\n\r\n            // we may have missed mouseup (out of window) - clean start, reset all\r\n            (this._mouseStarted && this._mouseUp(event));\r\n\r\n            // to compute the first (and the following) mouse move correctly\r\n            this._mouseDownEvent = event;\r\n\t\t\t// the above line only works for ie>8,  because _mouseDownEvent is a reference to the event\r\n\t\t\t// so in ie8 you have two references (_mouseDownEvent and event) which points to the same object, the window.event\r\n\t\t\t// to overcome this, you need a copy of the event e.g.\r\n\t\t\tif (!event.which) { // detect ie8\r\n\t\t\t\tvar copy = {};\r\n\t\t\t\tfor (var attr in event) {\r\n\t\t\t\t\tcopy[attr] = event[attr];\r\n\t\t\t\t}\r\n\t\t\t\tthis._mouseDownEvent = copy;\r\n\t\t\t}\r\n\r\n            // only left mouse button down is of interest\r\n\t\t\t// ie8 support\r\n            if (eventWhich(event) !== 1) {\r\n                return true;\r\n            }\r\n\r\n            // lets start and check distance first\r\n            if (this.options.distance == 0) {\r\n\t\t\t\tthis._mouseStarted = this._mousePrepareDrag(event) !== false;\r\n\t\t\t\tif (!this._mouseStarted) {\r\n\t\t\t\t\t// ie8 support\r\n\r\n\t\t\t\t\t(event.preventDefault ? event.preventDefault() : (event.returnValue=false));\r\n\t\t\t\t\t(event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true));\r\n\r\n\t\t\t\t\treturn true;\r\n                }\r\n            } else {\r\n\t\t\t\tthis._mousePrepareClick(event);\r\n\t\t\t}\r\n\r\n            // to keep context\r\n            var _this = this;\r\n            this._mouseMoveDelegate = function (event) {\r\n                return _this._mouseMove(event);\r\n            };\r\n            this._mouseUpDelegate = function (event) {\r\n                return _this._mouseUp(event);\r\n            };\r\n\r\n            addEvent(document.body, 'mousemove', this._mouseMoveDelegate);\r\n            addEvent(document.body, 'mouseup', this._mouseUpDelegate);\r\n\r\n\t\t\t// ie8 support\r\n\t\t\t(event.preventDefault ? event.preventDefault() : (event.returnValue=false));\r\n\t\t\t(event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true));\r\n\r\n            return true;\r\n\t\t}\r\n        function _mouseMove(event) {\r\n\t\t\t// ie8 support\r\n            event = getEvent(event);\r\n\r\n            // Iframe mouseup check - mouseup occurred in another document\r\n            if (!eventWhich(event)) {\r\n                return this._mouseUp(event);\r\n            }\r\n\r\n            // drag functionality\r\n            if (this._mouseStarted) {\r\n                this._mouseDrag(event);\r\n\r\n\t\t\t\t// ie8 support\r\n\t\t\t\t(event.preventDefault ? event.preventDefault() : (event.returnValue=false));\r\n\t\t\t\t(event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true));\r\n\r\n                return false;\r\n            }\r\n\r\n            // check distance (no action circle)\r\n            if (this._mouseDistanceMet(event, this._mouseDownEvent)) {\r\n\t\t\t\t// lets start\r\n                this._mouseStarted = (this._mousePrepareDrag(this._mouseDownEvent, event) !== false);\r\n\t\t\t\t// and move or stop\r\n                (this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));\r\n            }\r\n\r\n\t\t\t// ie8 support\r\n\t\t\t(event.preventDefault ? event.preventDefault() : (event.returnValue=false));\r\n\t\t\t(event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true));\r\n\r\n            return !this.mouseStarted;\r\n\t\t}\r\n        function _mouseUp(event) {\r\n\t\t\t// ie8 support\r\n            event = getEvent(event);\r\n\r\n            removeEvent(document.body, 'mousemove', this._mouseMoveDelegate);\r\n            removeEvent(document.body, 'mouseup', this._mouseUpDelegate);\r\n\r\n            if (this._mouseStarted) {\r\n                this._mouseStarted = false;\r\n\r\n\t\t\t\tthis._mouseStopDrag(event);\r\n            } else {\r\n\t\t\t\tthis._mouseExecuteClick(event);\r\n\t\t\t}\r\n\r\n\t\t\t// ie8 support\r\n\t\t\t(event.preventDefault ? event.preventDefault() : (event.returnValue=false));\r\n\t\t\t(event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true));\r\n\r\n            return false;\r\n\t\t}\r\n        function _mouseDistanceMet(newEvent, lastEvent) {\r\n\t\t\tvar x = Math.abs(eventPageX(lastEvent) - eventPageX(newEvent)),\r\n\t\t\t\ty = Math.abs(eventPageY(lastEvent) - eventPageY(newEvent));\r\n\t\t\treturn (Math.sqrt(x*x + y*y)) >= this.options.distance;\r\n\t\t}\r\n\r\n        // These are placeholder methods, to be overriden by extentions\r\n        function _mousePrepareClick() {}\r\n\t\tfunction _mousePrepareDrag() {}\r\n        function _mouseDrag(event) {}\r\n        function _mouseExecuteClick() {}\r\n\t\tfunction _mouseStopDrag() {}\r\n\r\n\t\treturn {\r\n\t\t\tconstructor: MouseHandler,\r\n\t\t\toptions: {\r\n\t\t\t\tdistance: 0,\r\n        changeColumn:function(){},//在new TableDrag传入的方法\r\n\t\t\t},\r\n\t\t\t_mouseDown: _mouseDown,\r\n\t\t\t_mouseMove: _mouseMove,\r\n\t\t\t_mouseUp: _mouseUp,\r\n\t\t\t_mouseDistanceMet: _mouseDistanceMet,\r\n\t\t\t_mousePrepareClick: _mousePrepareClick,\r\n\t\t\t_mousePrepareDrag: _mousePrepareDrag,\r\n\t\t\t_mouseDrag: _mouseDrag,\r\n\t\t\t_mouseExecuteClick: _mouseExecuteClick,\r\n\t\t\t_mouseStopDrag: _mouseStopDrag\r\n\t\t};\r\n\t})();\r\n\r\n    // This simple and small javascript solution for dragging html tables\r\n    // is roughly based on\r\n    // http://akottr.github.io/dragtable/\r\n    // and\r\n    // http://www.danvk.org/wp/dragtable/\r\n    function DragHandler(table, options) {\r\n\t\t//set default options\r\n\t\tthis.options.restoreState = true;\r\n        // set options\r\n\t\tvar newOptions = {};\r\n        for (var opt in this.options)\r\n\t\t\tnewOptions[opt] = (typeof options[opt] == 'undefined') ?  this.options[opt] : options[opt];\r\n\t\tthis.options = newOptions;\r\n\t\t// table\r\n\t\tthis.table = table;\r\n        // header row\r\n        this.hr = table.rows[0];\r\n\r\n      // number of columns\r\n\t\tthis.nc = this.hr.cells.length;\r\n        // number of rows\r\n        this.nr = table.rows.length;\r\n\r\n\t\tthis._init();\r\n    }\r\n    (function () {\r\n\t\tDragHandler.prototype = new MouseHandler();\r\n\t\tDragHandler.prototype.constructor = DragHandler;\r\n\r\n\t\t// helper functions\r\n\r\n\t\tfunction eventPageX(event) {\r\n\t\t\tvar pageX = event.pageX;\r\n\t\t\tif (typeof pageX == 'undefined') {\r\n\t\t\t\tvar body = document.body;\r\n\t\t\t\tvar docElem = document.documentElement;\r\n\t\t\t\tpageX = event.clientX + (docElem && docElem.scrollLeft || body && body.scrollLeft || 0) - (docElem && docElem.clientLeft || body && body.clientLeft || 0);\r\n\t\t\t}\r\n\t\t\treturn pageX;\r\n\t\t}\r\n        function elementStyleProperty(element, prop) {\r\n            if (window.getComputedStyle) {\r\n                return window.getComputedStyle(element, \"\").getPropertyValue(prop);\r\n            } else { // http://stackoverflow.com/questions/21797258/getcomputedstyle-like-javascript-function-for-ie8\r\n                var re = /(\\-([a-z]){1})/g;\r\n                if (prop == 'float') prop = 'styleFloat';\r\n                if (re.test(prop)) {\r\n                    prop = prop.replace(re, function () {\r\n                        return arguments[2].toUpperCase();\r\n                    });\r\n                }\r\n                return element.currentStyle[prop]\r\n            }\r\n        }\r\n\t\tfunction numericProperty(prop) {\r\n            return (typeof prop == 'undefined' || prop == '' || prop == null) ? 0 : parseInt(prop);\r\n        }\r\n\t\tfunction eventTarget (event) {\r\n\t\t\treturn event.target || event.srcElement;\r\n\t\t}\r\n\t\tfunction eventTargetTh (event) {\r\n      let e;\r\n      let type=Object.prototype.toString.call(event);\r\n      if(type===\"[object MouseEvent]\"||type===\"[object Object]\"){\r\n        e=event.target || event.srcElement;\r\n      }else{\r\n        e=event;\r\n      }\r\n      if(Object.prototype.toString.call(e)===\"[object HTMLTableCellElement]\"\r\n        ||Object.prototype.toString.call(e)===\"[object HTMLTableHeaderCellElement]\"){\r\n        //兼容性IE的table类型为[object HTMLTableHeaderCellElement]\r\n        return e;\r\n      }else{\r\n        return eventTargetTh(e.parentElement);\r\n      }\r\n\t\t}\r\n        function tridentDetection() {\r\n            return (navigator.userAgent.indexOf(\"Trident\") != -1) ? true : false;\r\n        };\r\n        function borderCollapseDetection(table) {\r\n            return elementStyleProperty(table, 'border-collapse') == 'collapse' ? true : false;\r\n        }\r\n\r\n\t\tfunction getTableColumn(table, pageX, defaultColumn) {\r\n\t\t\tvar cells = table.rows[0].cells;\r\n\t\t\tfor (var i = 0; i < cells.length; i++) {\r\n\t\t\t\tvar tx = getOffsetRect(cells[i]).left;\r\n\t\t\t\tif (tx <= pageX && pageX <= tx + cells[i].offsetWidth) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn (typeof defaultColumn == 'undefined' ? -1 : defaultColumn);\r\n\t\t}\r\n\r\n\t\tfunction copyStyles(el) {\r\n\t\t\tvar cs = window.getComputedStyle ? window.getComputedStyle(el, null) : el.currentStyle,\r\n\t\t\t\tcss = '';\r\n\t\t\tfor (var i = 0; i < cs.length; i++) {\r\n\t\t\t\tvar style = cs[i];\r\n\t\t\t\tcss += style + ': ' + cs.getPropertyValue(style) + ';';\r\n\t\t\t}\r\n\t\t\treturn css;\r\n\t\t}\r\n\r\n\t\t// storage functions\r\n\t\t// load state and returns the array\r\n\t\tfunction loadState(key) {\r\n\t\t\tvar state = localStorage.getItem(key);\r\n\r\n\t\t\tif (state != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tstate = JSON.parse(state);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tstate = new Array();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstate = new Array();\r\n\t\t\t}\r\n\r\n\t\t\treturn state;\r\n\t\t}\r\n\t\tfunction getIndex(state, searchId) {\r\n\t\t\t//find element\r\n\t\t\tvar index = state.findIndex(function (element, index, array) {\r\n\t\t\t\tvar id = element.id;\r\n\t\t\t\tif (id != searchId) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn index;\r\n\t\t}\r\n\t\tfunction saveState(key, table /* name, prop*/) {\r\n\t\t\t// ie in offline mode can't use localStorage,\r\n\t\t\t// use alternative storage like\r\n\t\t\t// https://github.com/andris9/simpleStorage\r\n\t\t\t// or many more alternatives on\r\n\t\t\t// https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills\r\n\t\t\tif (!localStorage) {\r\n                console.log('localStorage not supported or not usable (i.e. ie in offline mode).');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar state = loadState(key),\r\n\t\t\t\tid = table.getAttribute('id'),\r\n\t\t\t\telement = {id: id},\r\n\t\t\t\tindex = getIndex(state, id);\r\n\r\n\t\t\tfor (var i = 2; i < arguments.length; i+=2) {\r\n\t\t\t\telement[arguments[i]] = arguments[i+1];\r\n\t\t\t}\r\n\r\n\t\t\t// place element\r\n\t\t\tif (index < 0) {\r\n\t\t\t\tstate.push(element);\r\n\t\t\t} else {\r\n\t\t\t\tstate.splice(index, 1, element);\r\n\t\t\t}\r\n\r\n\t\t\tlocalStorage.setItem(key, JSON.stringify(state));\r\n\t\t}\r\n\t\tfunction restoreState(key, table, name) {\r\n\t\t\t// ie in offline mode can't use localStorage,\r\n\t\t\t// use alternative storage like\r\n\t\t\t// https://github.com/andris9/simpleStorage\r\n\t\t\t// or many more alternatives on\r\n\t\t\t// https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills\r\n\t\t\tif (!localStorage) {\r\n                console.log('localStorage not supported or not usable (i.e. ie in offline mode).');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar state = loadState(key),\r\n\t\t\t\tid = table.getAttribute('id'),\r\n\t\t\t\tindex = getIndex(state, id),\r\n\t\t\t\tnc = table.rows[0].cells.length,\r\n\t\t\t\tpm = new Array(nc);\r\n\t\t\tfor (var i = 0; i < nc; i++) {\r\n\t\t\t\tpm[i] = i;\r\n\t\t\t}\r\n\r\n\t\t\tif (index >= 0) {\r\n\t\t\t\tvar element = state[index],\r\n\t\t\t\t\tmemory = element[name],\r\n\t\t\t\t\tlength = memory.length,\r\n\t\t\t\t\tnc = table.rows[0].cells.length;\r\n\r\n\t\t\t\t//check length\r\n\t\t\t\tif (nc == length) {\r\n                    for (var i = 0; i < length; i++) {\r\n                        var start = memory[i],\r\n                            end = i;\r\n                        pm.move(start, end);\r\n                        if (pm[i] != start) moveTableColumn(table, start, end);\r\n                    }\r\n\t\t\t\t\tpm = memory;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn pm;\r\n\t\t}\r\n\r\n\t\t// private functions\r\n\r\n\t\tDragHandler.prototype._init = function () {\r\n            this.pm = new Array(this.nc);\r\n\t\t\tfor (var i = 0; i < this.nc; i++) {\r\n\t\t\t\tthis.pm[i] = i;\r\n\t\t\t}\r\n\t\t\tif (this.options.restoreState)\r\n\t\t\t\tthis.pm = restoreState('table-drag', this.table, 'drag');\r\n\t\t};\r\n\r\n\t\t// the overriden placeholder methods\r\n\r\n\t\tDragHandler.prototype._mousePrepareDrag = function (event) {\r\n\t\t\tvar trident = tridentDetection(),\r\n\t\t\t\ttable = this.table,\r\n\t\t\t\tborderCollapse = borderCollapseDetection(table),\r\n\t\t\t\ttablePosition = getOffsetRect(table),\r\n\t\t\t\trow = table.rows[0],\r\n\t\t\t\trowPosition = getOffsetRect(row),\r\n\t\t\t\trowOffsetHeight = row.offsetHeight,\r\n\t\t\t\ttableClientLeft = trident ? (rowPosition.left - tablePosition.left) : table.clientLeft,\r\n\t\t\t\ttableClientTop = trident ? (rowPosition.top - tablePosition.top) : table.clientTop,\r\n\t\t\t\tbackLeft = borderCollapse ? tablePosition.left : (tablePosition.left + tableClientLeft),\r\n                backTop = borderCollapse ? tablePosition.top : (rowPosition.top),\r\n                backWidth = borderCollapse ? table.offsetWidth : table.offsetWidth - 2 * tableClientLeft,\r\n                backHeight = table.rows[0].offsetHeight,\r\n\t\t\t\tzIndex = numericProperty(table.style.zIndex),\r\n                zIndex = zIndex ? zIndex + 1 : 1,\r\n\t\t\t\t// initialColumn = eventTarget(event).cellIndex,\r\n        //由于table-drag的th里面不能包含其他元素，所以为了满足项目需求增加方法更改查找父元素为th,eventTargetTh--rain\r\n\t\t\t  \tinitialColumn = eventTargetTh(event).cellIndex,\r\n          backgroundColor = elementStyleProperty(table, 'background-color');\r\n      //在table的setting，重置table的列数时，nc的数据有问题，所以进行重置\r\n      // this.hr = table.rows[0];\r\n      // this.nc = this.hr.cells.length;\r\n\r\n            // last column, initial column\r\n            this.lc = this.ic = initialColumn;\r\n            // overlay - back\r\n            var back = document.createElement(\"div\");\r\n            back.style.position = 'absolute';\r\n            back.style.left = backLeft + 'px';\r\n            back.style.top = backTop + 'px';\r\n            back.style.width = backWidth + 'px';\r\n            // back.style.width = parentWidth;\r\n            back.style.height = backHeight + 'px';\r\n            back.style.backgroundColor = backgroundColor;\r\n            back.style.zIndex = zIndex;\r\n            back.className = \"csp-table-drag-container\";\r\n            //由于ant-table在列较多时，会滚动，会溢出ant-table标题区域,所以获取table父元素位置和大小，超出父元素位置，设置其opacity为0，视觉上看不见\r\n            var tableLeft=tablePosition.left;\r\n            var tableParent=table.parentElement;\r\n            var tableParentLeft=getOffsetRect(tableParent).left;\r\n            var tableParentWidth=parseInt(elementStyleProperty(tableParent,\"width\").slice(0,-2));\r\n            var limitLeft=tableParentLeft-tableLeft;\r\n            var limitRight=limitLeft+tableParentWidth;\r\n            //添加整个拖拽元素移动界限\r\n            this.limitRight=backWidth;\r\n            this.limitLeft=0;\r\n            this.minColumn=0;\r\n            this.maxColumn=this.nc;\r\n            // overlay - front\r\n            for (var i = 0; i < this.nc; i++) {\r\n              // if (row.cells[i].getAttribute(\"class\") !== \"ant-table-selection-column\") {\r\n              var cell = row.cells[i],\r\n                cellPosition = getOffsetRect(cell),\r\n                offsetWidth = cell.offsetWidth,\r\n                offsetHeight = cell.offsetHeight,\r\n                clientWidth = cell.clientWidth,\r\n                clientHeight = cell.clientHeight,\r\n                clientLeft = cell.clientLeft,\r\n                clientTop = cell.clientTop,\r\n                clientRight = offsetWidth - clientWidth - clientLeft,\r\n                clientBottom = offsetHeight - clientHeight - clientTop,\r\n                paddingTop = numericProperty(elementStyleProperty(cell, 'padding-top')),\r\n                paddingBottom = numericProperty(elementStyleProperty(cell, 'padding-bottom')),\r\n                temp = cell.getBoundingClientRect(),\r\n                computedCellHeight = temp.bottom - temp.top - clientTop - clientBottom - paddingTop - paddingBottom,\r\n                borderLeftWidth = borderCollapse ? (clientRight + clientLeft) : clientLeft,\r\n                borderTopWidth = borderCollapse ? (clientTop + clientBottom) : clientTop,\r\n                borderRightWidth = borderCollapse ? (clientRight + clientLeft) : clientRight,\r\n                borderBottomWidth = borderCollapse ? (clientTop + clientBottom) : clientBottom,\r\n                elementBaseLeft = borderCollapse ? (cellPosition.left - backLeft - tableClientLeft) : cellPosition.left - backLeft,\r\n                elementBaseTop = borderCollapse ? (cellPosition.top - backTop - tableClientTop) : cellPosition.top - backTop,\r\n                elementBaseWidth = clientWidth + borderLeftWidth + borderRightWidth,\r\n                elementBaseHeight = rowOffsetHeight;\r\n\r\n              var element = document.createElement(\"div\");\r\n              element.style.cssText = copyStyles(cell);\r\n              element.style.position = 'absolute';\r\n              element.style.left = 0;\r\n              element.style.top = 0;\r\n              element.style.height = computedCellHeight+1 + 'px';//高度+1，拖拽时候比ant-table的标题少1px，没找到原因，可能因为子元素样式引起的问题\r\n              element.style.borderLeftWidth = borderLeftWidth + 'px';\r\n              element.style.borderTopWidth = borderTopWidth + 'px';\r\n              element.style.borderRightWidth = borderRightWidth + 'px';\r\n              element.style.borderBottomWidth = borderBottomWidth + 'px';\r\n              element.innerHTML = cell.innerHTML;\r\n              element.style.zIndex = zIndex + 3;\r\n              //当ant-table含有复选框时，给复选框添加单独class\r\n              if(row.cells[i].getAttribute(\"class\") === \"ant-table-selection-column\"){\r\n                element.className=\"csp-table-drag-input\";\r\n              }\r\n              if (i == initialColumn) element.style.left = elementBaseLeft + 'px';\r\n              if (i == initialColumn) element.style.top = elementBaseTop + 'px';\r\n\r\n              var elementBase = document.createElement(\"div\");\r\n              elementBase.style.position = 'absolute';\r\n              elementBase.style.left = elementBaseLeft + 'px';\r\n              elementBase.style.top = elementBaseTop+ 'px';\r\n              elementBase.style.height = elementBaseHeight + 'px';\r\n              elementBase.style.width = elementBaseWidth + 'px';\r\n              elementBase.style.backgroundColor = 'white';\r\n              elementBase.style.zIndex = zIndex + 2;\r\n              //当ant-table含有复选框时，给复选框容器添加data-checkbox，自定义属性区分，暂时没对这个属性进行应用\r\n              if(row.cells[i].getAttribute(\"class\") === \"ant-table-selection-column\"){\r\n                elementBase.setAttribute('data-checkbox','checkbox');\r\n              }\r\n              if (i == initialColumn) elementBase.style.zIndex = zIndex + 1;\r\n\r\n              // drag element\r\n              if (i == initialColumn) this.de = element;\r\n              if (i != initialColumn) elementBase.appendChild(element);\r\n\r\n              //当元素位置超过ant-table的左右边界限制时，使元素的opacity为0，视觉上看不见\r\n              var elementBaseLimitRight=elementBaseLeft+elementBaseWidth;\r\n              if(!(elementBaseLeft>=limitLeft&&elementBaseLimitRight<=limitRight)){\r\n                // elementBase.style.opacity=0;\r\n                elementBase.setAttribute(\"class\",\"csp-opacity\");\r\n                if(i == initialColumn){\r\n                  this.de.style.opacity=0;\r\n                  return false;\r\n                }\r\n              }\r\n              //添加整个拖拽元素移动界限\r\n              if(!(elementBaseLeft>=limitLeft)){\r\n                this.limitLeft=elementBaseLeft+elementBaseWidth;\r\n                this.minColumn=i+1;\r\n              }\r\n              if(!(elementBaseLimitRight<=limitRight)){\r\n                this.limitRight=elementBaseLeft>this.limitRight?this.limitRight:elementBaseLeft;\r\n                this.maxColumn=i<this.maxColumn?i-1:this.maxColumn;\r\n              }\r\n              // console.log(\"elementBaseLeft\",elementBaseLeft);\r\n              // console.log(\"limitLeft\",limitLeft);\r\n              // console.log(\"this.limitLeft\",this.limitLeft);\r\n              // console.log(\"limitRight\",limitRight);\r\n              // console.log(\"this.limitRight\",this.limitRight);\r\n              // console.log(\"elementBaseLimitRight\",elementBaseLimitRight);\r\n              back.appendChild(elementBase);\r\n              // console.log(\"elementBaseLeft\",elementBaseLeft);\r\n            // }\r\n            }\r\n            back.appendChild(this.de);\r\n            document.body.appendChild(back);\r\n            this.overlay = back;\r\n\r\n            // replace current document cursor\r\n            this.cur = document.body.style.cursor;\r\n            document.body.style.cursor = 'move';\r\n\r\n            return true;\r\n\t\t};\r\n\t\tDragHandler.prototype._mouseDrag = function (event) {\r\n      var distance = eventPageX(event) - eventPageX(this._mouseDownEvent),\r\n        table = this.table,\r\n        lastColumn = this.lc,\r\n        eventColumn = getTableColumn(table, eventPageX(event), lastColumn);//这个地方出问题\r\n      //增加判断限制，在边界限定范围内，才可移动\r\n      // var limitRight = this.limitRight;\r\n      // var limitLeft = this.limitLeft;\r\n      // var positionLeft = numericProperty(this.de.style.left) + distance;\r\n      // var eventWidth = parseInt(elementStyleProperty(this.de, \"width\").slice(0, -2));\r\n      //console.log(\"lastColumn\",lastColumn);//当前移动的column的序号\r\n      //console.log(\"eventColumn\",eventColumn);//当前移动元素到哪个column的序号\r\n      eventColumn<this.minColumn?eventColumn=this.minColumn:eventColumn>this.maxColumn?eventColumn=this.maxColumn:eventColumn;\r\n      // if (positionLeft >= limitLeft && positionLeft <= (limitRight - eventWidth))\r\n        // this.tableMove=true;\r\n        //原代码\r\n      this.de.style.left = numericProperty(this.de.style.left) + distance + 'px';\r\n        if (eventColumn != lastColumn) { // bubble\r\n          var trident = tridentDetection(),\r\n            borderCollapse = borderCollapseDetection(table),\r\n            borderSpacing = borderCollapse ? 0 : numericProperty(elementStyleProperty(table, 'border-spacing')),\r\n            direction = sign(eventColumn - lastColumn);\r\n          for (var i = lastColumn; i != eventColumn; i += direction) {\r\n\r\n            var start = i,\r\n              end = start + direction,\r\n              shift = 0,\r\n              shift = (direction < 0 && start > this.ic) ? 1 : ((direction > 0 && start < this.ic) ? -1 : 0),\r\n              layerOne = this.overlay.childNodes[direction < 0 ? this.ic : (end + shift)],\r\n              layerTwo = this.overlay.childNodes[direction > 0 ? this.ic : (end + shift)],\r\n              borderLeftWidth = numericProperty(elementStyleProperty(direction < 0 ? layerTwo.childNodes[0] : this.de, 'border-left-width')),\r\n              borderLeftWidth = borderCollapse ? borderLeftWidth : 0,\r\n              left = numericProperty(layerTwo.style.left),\r\n              width = numericProperty(layerOne.style.width);\r\n            layerOne.style.left = left + 'px';\r\n            layerTwo.style.left = left + width + borderSpacing - borderLeftWidth + 'px';\r\n            //layerOne.setAttribute(\"class\",\"csp-move-column\")//可能没用\r\n            //layerOne 移动的空白站位\r\n            //layerTwo 其他已经移动位置元素\r\n            // console.log(\"layerOne\", layerOne);\r\n            // console.log(\"layerTwo\", layerTwo);\r\n\r\n\r\n\r\n\r\n\r\n            // shift\r\n            this.pm.move(start, end);\r\n            // set new column\r\n            this.lc = end;\r\n          }\r\n\r\n          if (this.options.restoreState)\r\n            saveState('table-drag', this.table, 'drag', this.pm);\r\n        }\r\n        this._mouseDownEvent = event;\r\n        if (!event.which) { // detect ie8\r\n          var copy = {};\r\n          for (var attr in event) {\r\n            copy[attr] = event[attr];\r\n          }\r\n          this._mouseDownEvent = copy;\r\n        }\r\n\r\n\t\t}\r\n\t\tDragHandler.prototype._mouseStopDrag = function (event) {\r\n            // remove overlay\r\n            document.body.removeChild(this.overlay);\r\n            // console.log(this.overlay);\r\n            // move column if neccessary\r\n      // if(this.tableMove){\r\n\r\n\r\n\t\t\tvar table = this.table,\r\n\t\t\t\tcol = getTableColumn(table, eventPageX(event), this.lc);\r\n            if (col != this.ic){\r\n              col<this.minColumn?col=this.minColumn:col>this.maxColumn?col=this.maxColumn:col;\r\n              //原来通过移动table的th去实现的方法\r\n              // moveTableColumn(table, this.ic, col);\r\n              //添加一个方法，为了让在拖拽后传入到table组件\r\n              this.options.changeColumn(this.ic,col);\r\n\r\n            }\r\n\r\n\r\n\r\n            // restore mouse cursor\r\n      // }\r\n            document.body.style.cursor = this.cur;\r\n\r\n\t\t};\r\n\t})();\r\n  function elementStyleProperty(element, prop) {\r\n    if (window.getComputedStyle) {\r\n      return window.getComputedStyle(element, \"\").getPropertyValue(prop);\r\n    } else { // http://stackoverflow.com/questions/21797258/getcomputedstyle-like-javascript-function-for-ie8\r\n      var re = /(\\-([a-z]){1})/g;\r\n      if (prop == 'float') prop = 'styleFloat';\r\n      if (re.test(prop)) {\r\n        prop = prop.replace(re, function () {\r\n          return arguments[2].toUpperCase();\r\n        });\r\n      }\r\n      return element.currentStyle[prop]\r\n    }\r\n  }\r\n    function TableDrag(table, options) {\r\n\t\t// check input\r\n        if (table && table.tagName !== 'TABLE') {\r\n\t\t\tconsole.log('ERROR: DOM element/input is not a table!');\r\n            return;\r\n        }\r\n\r\n        // check empty table\r\n        if (!(table && table.rows && table.rows.length > 0)) {\r\n\t\t\tconsole.log('WARNING: Empty table.');\r\n            return;\r\n        }\r\n        var dragHandler = new DragHandler(table, options || {});\r\n        for (var i = 0; i < dragHandler.nc; i++) {\r\n          var cell = dragHandler.hr.cells[i];\r\n          //增加判断，如果包含ant-table的复选列，复选了的class为ant-table-selection-column，则不添加鼠标事件\r\n          if(cell.getAttribute(\"class\") !== \"ant-table-selection-column\"){\r\n\t\t\t// add move cursor\r\n            cell.style.cursor = 'move';\r\n\r\n            addEvent(cell, 'mousedown', function (event) {\r\n                dragHandler._mouseDown(event);\r\n            });\r\n          }\r\n        }\r\n    }\r\n\r\n    // export\r\n\r\n    if (typeof module !== 'undefined' && module.exports) {\r\n        module.exports = TableDrag;\r\n    } else {\r\n        window.TableDrag = TableDrag;\r\n    }\r\n\r\n    // polyfills and public code snippets\r\n\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex\r\n\tif (!Array.prototype.findIndex) {\r\n\t\ttry {\r\n\t\t\tObject.defineProperty(Array.prototype, 'findIndex', {\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\twritable: true,\r\n\t\t\t\tvalue: function (predicate) {\r\n\t\t\t\t\tif (this == null) {\r\n\t\t\t\t\t\tthrow new TypeError('Array.prototype.find called on null or undefined');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (typeof predicate !== 'function') {\r\n\t\t\t\t\t\tthrow new TypeError('predicate must be a function');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list = Object(this);\r\n\t\t\t\t\tvar length = list.length >>> 0;\r\n\t\t\t\t\tvar thisArg = arguments[1];\r\n\t\t\t\t\tvar value;\r\n\r\n\t\t\t\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\t\t\t\tif (i in list) {\r\n\t\t\t\t\t\t\tvalue = list[i];\r\n\t\t\t\t\t\t\tif (predicate.call(thisArg, value, i, list)) {\r\n\t\t\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (e) { // ie8 support\r\n\t\t\tArray.prototype.findIndex = function(predicate) {\r\n\t\t\t\t\tif (this == null) {\r\n\t\t\t\t\t\tthrow new TypeError('Array.prototype.find called on null or undefined');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (typeof predicate !== 'function') {\r\n\t\t\t\t\t\tthrow new TypeError('predicate must be a function');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar list = Object(this);\r\n\t\t\t\t\tvar length = list.length >>> 0;\r\n\t\t\t\t\tvar thisArg = arguments[1];\r\n\t\t\t\t\tvar value;\r\n\r\n\t\t\t\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\t\t\t\tif (i in list) {\r\n\t\t\t\t\t\t\tvalue = list[i];\r\n\t\t\t\t\t\t\tif (predicate.call(thisArg, value, i, list)) {\r\n\t\t\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n    // http://ejohn.org/apps/jselect/event.html\r\n    function addEvent(obj, type, fn) {\r\n        if (obj.attachEvent) {\r\n            obj['e' + type + fn] = fn;\r\n            obj[type + fn] = function () {\r\n                obj['e' + type + fn](window.event);\r\n            };\r\n            obj.attachEvent('on' + type, obj[type + fn]);\r\n        } else\r\n            obj.addEventListener(type, fn, false);\r\n    }\r\n    function removeEvent(obj, type, fn) {\r\n        if (obj.detachEvent) {\r\n            obj.detachEvent('on' + type, obj[type + fn]);\r\n            obj[type + fn] = null;\r\n        } else\r\n            obj.removeEventListener(type, fn, false);\r\n    }\r\n\r\n   // http://javascript.info/tutorial/coordinates\r\n    function getOffsetRect(elem) {\r\n        // (1)\r\n        var box = elem.getBoundingClientRect();\r\n\r\n        var body = document.body;\r\n        var docElem = document.documentElement;\r\n\r\n        // (2)\r\n        var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n        var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\r\n        // (3)\r\n        var clientTop = docElem.clientTop || body.clientTop || 0;\r\n        var clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n\r\n        // (4)\r\n        var top = box.top + scrollTop - clientTop;\r\n        var left = box.left + scrollLeft - clientLeft;\r\n\r\n        return { top: Math.round(top), left: Math.round(left) };\r\n    }\r\n\r\n    // based on\r\n    // https://groups.google.com/forum/#!msg/comp.lang.javascript/durZ17iSD0I/rnH2FqrvkooJ\r\n    function moveTableColumn(table, start, end) {\r\n      //为了项目需求，在更改table顺序时，触发项目绑定事件changeColumn，从而更改table的顺序\r\n        console.log(\"触发move\");\r\n        var row,\r\n            i = table.rows.length;\r\n        while (i--) {\r\n            row = table.rows[i];\r\n            //增加判断，如果移动的是有ant-table的复选框，则不进行移动\r\n            if(row.cells[end].getAttribute(\"class\")!==\"ant-table-selection-column\"){\r\n              var x = row.removeChild(row.cells[start]);\r\n              row.insertBefore(x, row.cells[end]);\r\n            }else{\r\n              var x = row.removeChild(row.cells[start]);\r\n              row.insertBefore(x, row.cells[1]);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    // http://stackoverflow.com/questions/7624920/number-sign-in-javascript\r\n    function sign(x) {\r\n        return typeof x == 'number' ? x ? x < 0 ? -1 : 1 : x === x ? 0 : NaN : NaN;\r\n    }\r\n\r\n    // http://stackoverflow.com/questions/2440700/reordering-arrays\r\n    Array.prototype.move = function (from, to) {\r\n        this.splice(to, 0, this.splice(from, 1)[0]);\r\n    };\r\n\r\n})();\r\n"]}